LOAD EMPLOYEE
LOAD DEPARTMENT
LOAD PROJECT
LOAD WORKS_ON
Q1_TEMP <- SELECT Salary >= 30000 FROM EMPLOYEE
Q1 <- PROJECT Ssn, Salary FROM Q1_TEMP
EXPORT Q1
Q2_TEMP1 <- CROSS EMPLOYEE EMPLOYEE
Q2_TEMP2 <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM Q2_TEMP1
Q2_TEMP3 <- SELECT EMPLOYEE1_Bdate == EMPLOYEE2_Bdate FROM Q2_TEMP2
Q2 <- PROJECT EMPLOYEE1_Ssn, EMPLOYEE1_Super_ssn, EMPLOYEE1_Bdate FROM Q2_TEMP3
RENAME EMPLOYEE1_Ssn TO Ssn FROM Q2
RENAME EMPLOYEE1_Super_ssn TO Super_ssn FROM Q2
RENAME EMPLOYEE1_Bdate TO Bdate FROM Q2
EXPORT Q2
Q3_TEMP1 <- CROSS EMPLOYEE WORKS_ON
Q3_TEMP2 <- SELECT Ssn == Essn FROM Q3_TEMP1
Q3_TEMP3 <- SELECT Sex == 1 FROM Q3_TEMP2
Q3_TEMP4 <- SELECT Sex == 0 FROM Q3_TEMP2
Q3_TEMP5 <- CROSS Q3_TEMP3 Q3_TEMP4
Q3_TEMP6 <- SELECT Q3_TEMP3_Pno == Q3_TEMP4_Pno FROM Q3_TEMP5
Q3 <- PROJECT Q3_TEMP3_Pno FROM Q3_TEMP6
RENAME Q3_TEMP3_Pno TO Pno FROM Q3
EXPORT Q3
Q4_TEMP1 <- CROSS EMPLOYEE WORKS_ON
Q4_TEMP2 <- SELECT Ssn == Essn FROM Q4_TEMP1
Q4_TEMP3 <- CROSS Q4_TEMP2 Q4_TEMP2
Q4_TEMP4 <- SELECT Q4_TEMP21_Super_ssn == Q4_TEMP22_Ssn FROM Q4_TEMP3
Q4_TEMP5 <- SELECT Q4_TEMP21_Pno == Q4_TEMP22_Pno FROM Q4_TEMP4
Q4 <- PROJECT Q4_TEMP21_Ssn, Q4_TEMP21_Super_ssn, Q4_TEMP21_Pno FROM Q4_TEMP5
RENAME Q4_TEMP21_Ssn TO Ssn FROM Q4
RENAME Q4_TEMP21_Super_ssn TO Super_ssn FROM Q4
RENAME Q4_TEMP21_Pno TO Pno FROM Q4
EXPORT Q4
Q5_TEMP1 <- SELECT Dnum >= 1 FROM PROJECT
Q5_TEMP2 <- SELECT Dnum <= 5 FROM Q5_TEMP1
Q5_TEMP3 <- SELECT Dnum != 2 FROM Q5_TEMP2
Q5_TEMP4 <- SELECT Dnum != 3 FROM Q5_TEMP3
Q5 <- SELECT Dnum != 4 FROM Q5_TEMP4
EXPORT Q5
QUIT
